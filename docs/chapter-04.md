
## 4. 좋은 단위 테스트의 4대 요소

* 테스트는 개발 주기에 통합되어야 한다. 
* 실제로 사용하는 테스트에만 가치가 있고, 그렇지 않으면 작성해도 의미가 없다.
* 코드베이스의 가장 중요한 부분만을 대상으로 한다.
* 모든 실행 코드에 똑같이 신경 쓸 필요가 없다.
* 어플리케이션의 핵심(도메인 모델)을 다른 것과 구별하는 것이 중요하다.
* 최소한의 유지비로 최대 가치를 끌어낸다.

가치 있는 테스트를 식별하는 것과 가치 있는 테스트를 작성하는 것은 별개의 기술이다. 
가치 있는 테스트를 작성하려면 가치 있는 테스트 식별이 필요하다. 

### 4.1. 좋은 단위 테스트의 4대 요소 자세히 살펴보기

좋은 단위 테스트에는 네 가지 특성이 있다.

* 회귀 방지
* 리팩토링 내성
* 빠른 피드백
* 유지 보수성

#### 4.1.1. 첫 번째 요소: 회귀 방지

회귀는 코드를 수정한 후 기능이 의도한 대로 작동하지 않는 경우이다. 
즉, 소프트웨어 버그를 의미한다. 
개발할 기능이 많을수록 새로운 릴리즈에서 기능이 고장 날 가능성이 높다. 
코드는 자산이 아니라 책임이다. 
코드 베이스가 커질수록 잠재적인 버그에 더 많이 노출된다. 

회귀 방지 지표에 대한 테스트 점수가 얼마나 잘 나오는지 평가하려면 다음 사항을 고려한다.

* 테스트 중에 실행되는 코드의 양
* 코드 복잡도
* 코드의 도메인 유의성

일반적으로 실행되는 코드가 많을수록 테스트에서 회귀가 나타날 가능성이 높다. 
코드가 예외를 발생시키지 않고 실행된다는 것을 아는 데 도움은 되지만, 코드가 생성하는 결과가 유효한지도 확인해야 한다. 
단순한 코드를 테스트하는 것은 가치가 없다. 
단순한 코드를 다루는 테스트는 실수할 여지가 많지 않아서 회귀 오류가 발생하지 않는다. 
라이브러리, 프레임워크 같이 직접 작성하지 않은 코드에 대한 테스트도 중요하다. 
최상의 보호를 위해선 테스트가 해당 라이브러리, 프레임워크, 외부 시스템을 테스트 범주에 포함시켜서 소프트웨어가 의존성에 대한 검증이 올바른지 확인해야 한다. 
회귀 방지 지표를 극대화하려면 테스트가 가능한 많은 코드를 실행하는 것이 좋다. 

#### 4.1.2. 두 번째 요소: 리팩토링 내성

테스트를 빨간색으로 바꾸지 않고 기본 어플리케이션 코드를 리팩토링할 수 있는지에 대한 척도이다. 

